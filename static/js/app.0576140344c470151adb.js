webpackJsonp([1],{"/Ai2":function(e,t){},"1nDT":function(e,t){},"6ZWM":function(e,t){},"Cm+n":function(e,t){},DaeS:function(e,t){},EPR5:function(e,t){},GlBT:function(e,t,r){"use strict";var a=r("wJg8"),n=r.n(a),s=r("OVeQ");var i=function(e){r("EPR5")},o=r("VU/8")(n.a,s.a,!1,i,"data-v-c2dce65e",null);t.default=o.exports},IYC2:function(e,t){},J373:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("7+uW"),n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var s=r("VU/8")({name:"app"},n,!1,function(e){r("tBG6")},null,null).exports,i=r("zL8q"),o=r.n(i),l=(r("tvR6"),r("/ocq")),u=r("Xxa5"),c=r.n(u),d=r("exGp"),m=r.n(d),p={data:function(){return{loginForm:{username:"",password:""},loginFormRules:{username:[{required:!0,message:"请输入登录名称",trigger:"blur"},{min:3,max:10,message:"长度在3到10个字符区间",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"},{min:6,max:16,message:"长度在6到16个字符区间",trigger:"blur"}]}}},methods:{resetLoginFrom:function(){this.$refs.loginFormRef.resetFields()},verifyLoginInfo:function(){var e,t=this;this.$refs.loginFormRef.validate((e=m()(c.a.mark(function e(r){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("login",t.loginForm);case 4:if(a=e.sent,console.log(a),200===a.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("登陆失败"));case 8:window.sessionStorage.setItem("token",a.data.data.token),t.$router.push("/home"),t.$message.success("登录成功");case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))}}},f={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login_container"},[r("div",{staticClass:"login_box"},[r("el-form",{ref:"loginFormRef",staticClass:"login_from",attrs:{model:e.loginForm,rules:e.loginFormRules,"label-width":"0px"}},[r("h1",{staticClass:"login_title"},[e._v("公路港后台管理系统")]),e._v(" "),r("el-form-item",{attrs:{prop:"username"}},[r("el-input",{attrs:{"prefix-icon":"el-icon-user"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.verifyLoginInfo()}},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"password"}},[r("el-input",{attrs:{"prefix-icon":"el-icon-lock",type:"password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.verifyLoginInfo()}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),e._v(" "),r("el-form-item",{staticClass:"buttons"},[r("el-button",{attrs:{type:"primary"},on:{click:e.verifyLoginInfo}},[e._v("Login")]),e._v(" "),r("el-button",{attrs:{type:"info"},on:{click:e.resetLoginFrom}},[e._v("Reset")])],1)],1)],1)])},staticRenderFns:[]};var g=r("VU/8")(p,f,!1,function(e){r("qkMw")},"data-v-4d9e8ba0",null).exports,b={data:function(){return{menuList:[],iconList:["el-icon-user","el-icon-set-up","el-icon-goods","el-icon-s-order","el-icon-s-data"],isCollapse:!1}},created:function(){this.getMenuList()},methods:{userLogout:function(){window.sessionStorage.clear(),this.$router.push("/login")},getMenuList:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("menus");case 2:if(r=t.sent,console.log(r),200===r.data.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error(r.data.meta.meg));case 6:e.menuList=r.data.data,console.log(e.menuList);case 8:case"end":return t.stop()}},t,e)}))()},toggleCollapse:function(){this.isCollapse=!this.isCollapse}}},v={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",{staticClass:"home-container"},[r("el-header",[r("span",[e._v("公路港后台管理系统")]),e._v(" "),r("el-button",{attrs:{type:"info"},on:{click:e.userLogout}},[e._v("退出")])],1),e._v(" "),r("el-container",[r("el-aside",{attrs:{width:e.isCollapse?"64px":"200px"}},[r("div",{staticClass:"toggle-button",on:{click:e.toggleCollapse}},[e._v("|||")]),e._v(" "),r("el-menu",{attrs:{"background-color":"#333744","text-color":"#ffffff","default-active":e.$route.path,"unique-opened":"",router:"",collapse:e.isCollapse,"collapse-transition":!1}},e._l(e.menuList,function(t,a){return r("el-submenu",{key:t.id,attrs:{index:t.id+""}},[r("template",{slot:"title"},[r("i",{class:e.iconList[a]}),e._v(" "),r("span",[e._v(e._s(t.authName))])]),e._v(" "),e._l(t.children,function(t){return r("el-menu-item",{key:t.id,attrs:{index:"/"+t.path}},[r("template",{slot:"title"},[r("i",{staticClass:"el-icon-menu"}),e._v(" "),r("span",[e._v(e._s(t.authName))])])],2)})],2)}),1)],1),e._v(" "),r("el-main",[r("router-view")],1)],1)],1)},staticRenderFns:[]};var h=r("VU/8")(b,v,!1,function(e){r("Ykfr")},"data-v-4be00c51",null).exports,_={render:function(){var e=this.$createElement;return(this._self._c||e)("h3",[this._v("Welcome")])},staticRenderFns:[]},y=r("VU/8")(null,_,!1,null,null,null).exports,k={data:function(){var e=function(e,t,r){if(/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/.test(t))return r();r(new Error("请输入合法的邮箱"))},t=function(e,t,r){if(/^(0|86|17951)?(13[0-9]|14[57]|15[012356789]|17[678]|18[0-9])[0-9]{8}$/.test(t))return r();r(new Error("请输入合法的号码"))};return{queryInfo:{params:"",pagenum:1,pagesize:10},addUserForm:{username:"",password:"",email:"",mobile:""},editUserForm:{username:"",email:"",mobile:""},addUserRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"用户名的长度在3到10个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"密码的长度在6到16个字符之间",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入电话",trigger:"blur"},{validator:t,trigger:"blur"}]},editUserRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:e,trigger:"blur"}],mobile:[{required:!0,message:"请输入电话",trigger:"blur"},{validator:t,trigger:"blur"}]},userList:[],userInfo:{},roleList:[],userListSize:0,addDialogVisible:!1,editDialogVisible:!1,setRoleDgialogVisible:!1,selectedRoleId:""}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("users",{params:e.queryInfo});case 2:if(r=t.sent,console.log(r.data),200===r.data.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取数据失败"));case 6:e.userList=r.data.data.users,e.userListSize=r.data.data.total;case 8:case"end":return t.stop()}},t,e)}))()},handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getUserList()},changeUserStatus:function(e){var t=this;return m()(c.a.mark(function r(){var a;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$http.put("users/"+e.id+"/state/"+e.mg_state);case 2:if(a=r.sent,console.log(a),200===a.data.meta.status){r.next=7;break}return e.mg_state=!e.mg_state,r.abrupt("return",t.$message.error("用户状态更新失败"));case 7:t.$message.success("用户状态更新成功");case 8:case"end":return r.stop()}},r,t)}))()},addUserCloseDialog:function(){this.$refs.addUserFormRef.resetFields()},editUserCloseDialog:function(){this.$refs.editUserFormRef.resetFields()},setRoleCloseDialog:function(){this.selectedRoleId="",this.userInfo={}},addUser:function(){var e,t=this;this.$refs.addUserFormRef.validate((e=m()(c.a.mark(function e(r){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("users",t.addUserForm);case 4:if(a=e.sent,console.log(a),201===a.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("新增用户失败"));case 8:t.$message.success("新增用户成功"),t.addDialogVisible=!1,t.getUserList();case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},showEditDialog:function(e){var t=this;return m()(c.a.mark(function r(){var a;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.editDialogVisible=!0,r.next=3,t.$http.get("users/"+e);case 3:if(a=r.sent,console.log(a),200===a.data.meta.status){r.next=7;break}return r.abrupt("return",t.$message.error("获取失败"));case 7:t.$message.success("获取成功"),t.editUserForm=a.data.data;case 9:case"end":return r.stop()}},r,t)}))()},editUser:function(){var e,t=this;this.$refs.editUserFormRef.validate((e=m()(c.a.mark(function e(r){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.put("users/"+t.editUserForm.id,{email:t.editUserForm.email,mobile:t.editUserForm.mobile});case 4:if(a=e.sent,console.log(a),200===a.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("修改用户失败"));case 8:t.$message.success("修改用户成功"),t.editDialogVisible=!1,t.getUserList();case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},deleteUser:function(e){var t=this;return m()(c.a.mark(function r(){return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 2:if("confirm"===r.sent){r.next=5;break}return r.abrupt("return",t.$message.info("取消删除用户"));case 5:return r.next=7,t.$http.delete("users/"+e);case 7:if(200===r.sent.data.meta.status){r.next=10;break}return r.abrupt("return",t.$message.error("删除用户失败"));case 10:t.$message.success("删除用户完毕"),t.getUserList();case 12:case"end":return r.stop()}},r,t)}))()},showSetRoleDialog:function(e){var t=this;return m()(c.a.mark(function r(){var a;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.userInfo=e,t.setRoleDgialogVisible=!0,r.next=4,t.$http.get("roles");case 4:if(a=r.sent,console.log(a),200===a.data.meta.status){r.next=8;break}return r.abrupt("return",t.$message.error("获取角色失败"));case 8:t.$message.success("获取角色成功"),t.roleList=a.data.data;case 10:case"end":return r.stop()}},r,t)}))()},setRole:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.selectedRoleId){t.next=2;break}return t.abrupt("return",e.$message.error("未选择角色"));case 2:return t.next=4,e.$http.put("users/"+e.userInfo.id+"/role",{rid:e.selectedRoleId});case 4:if(r=t.sent,console.log(r),200===r.data.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error("更改角色失败"));case 8:e.$message.success("更改角色成功"),e.setRoleDgialogVisible=!1,e.getUserList();case 11:case"end":return t.stop()}},t,e)}))()}}},w={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/welcome"}}},[e._v("首页")]),e._v(" "),r("el-breadcrumb-item",[e._v("用户管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("用户列表")])],1),e._v(" "),r("el-card",[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:7}},[r("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{clear:e.getUserList},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getUserList(t)}},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),e._v(" "),r("el-col",{attrs:{span:4}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加用户")])],1)],1),e._v(" "),r("el-table",{attrs:{data:e.userList,stripe:""}},[r("el-table-column",{attrs:{label:"#",type:"index"}}),e._v(" "),r("el-table-column",{attrs:{label:"姓名",prop:"username"}}),e._v(" "),r("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),e._v(" "),r("el-table-column",{attrs:{label:"电话",prop:"mobile"}}),e._v(" "),r("el-table-column",{attrs:{label:"角色",prop:"role_name"}}),e._v(" "),r("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{on:{change:function(r){return e.changeUserStatus(t.row)}},model:{value:t.row.mg_state,callback:function(r){e.$set(t.row,"mg_state",r)},expression:"scope.row.mg_state"}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showEditDialog(t.row.id)}}}),e._v(" "),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteUser(t.row.id)}}}),e._v(" "),r("el-tooltip",{attrs:{effect:"dark",content:"分配角色",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(r){return e.showSetRoleDialog(t.row)}}})],1)]}}])})],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[10,25,50],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.userListSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{title:"添加用户",visible:e.addDialogVisible,width:"40%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addUserCloseDialog}},[r("el-form",{ref:"addUserFormRef",attrs:{model:e.addUserForm,rules:e.addUserRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addUser(t)}},model:{value:e.addUserForm.username,callback:function(t){e.$set(e.addUserForm,"username",t)},expression:"addUserForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addUser(t)}},model:{value:e.addUserForm.password,callback:function(t){e.$set(e.addUserForm,"password",t)},expression:"addUserForm.password"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addUser(t)}},model:{value:e.addUserForm.email,callback:function(t){e.$set(e.addUserForm,"email",t)},expression:"addUserForm.email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"电话",prop:"mobile"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addUser(t)}},model:{value:e.addUserForm.mobile,callback:function(t){e.$set(e.addUserForm,"mobile",t)},expression:"addUserForm.mobile"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"修改用户",visible:e.editDialogVisible,width:"40%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editUserCloseDialog}},[r("el-form",{ref:"editUserFormRef",attrs:{model:e.editUserForm,rules:e.editUserRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.editUserForm.username,callback:function(t){e.$set(e.editUserForm,"username",t)},expression:"editUserForm.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editUser(t)}},model:{value:e.editUserForm.email,callback:function(t){e.$set(e.editUserForm,"email",t)},expression:"editUserForm.email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"电话",prop:"mobile"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editUser(t)}},model:{value:e.editUserForm.mobile,callback:function(t){e.$set(e.editUserForm,"mobile",t)},expression:"editUserForm.mobile"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.editUser}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"分配角色",visible:e.setRoleDgialogVisible,width:"40%"},on:{"update:visible":function(t){e.setRoleDgialogVisible=t},close:e.setRoleCloseDialog}},[r("el-form",[r("p",[e._v("当前的用户："+e._s(e.userInfo.username))]),e._v(" "),r("p",[e._v("当前的角色："+e._s(e.userInfo.role_name))]),e._v(" "),r("p",[e._v("请选择新角色：\n                "),r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectedRoleId,callback:function(t){e.selectedRoleId=t},expression:"selectedRoleId"}},e._l(e.roleList,function(e){return r("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})}),1)],1)]),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.setRoleDgialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.setRole}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var x=r("VU/8")(k,w,!1,function(e){r("IYC2")},"data-v-1f006c30",null).exports,C={data:function(){return{rightsList:[]}},created:function(){this.getRightsList()},methods:{getRightsList:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("rights/list");case 2:if(200===(r=t.sent).data.meta.status){t.next=5;break}return t.abrupt("return",e.$message.error("获取权限列表失败"));case 5:console.log(r),e.rightsList=r.data.data;case 7:case"end":return t.stop()}},t,e)}))()}}},$={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/welcome"}}},[e._v("首页")]),e._v(" "),r("el-breadcrumb-item",[e._v("权限管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("权限列表")])],1),e._v(" "),r("el-card",[r("el-table",{attrs:{data:e.rightsList,stripe:""}},[r("el-table-column",{attrs:{label:"#",type:"index"}}),e._v(" "),r("el-table-column",{attrs:{label:"名称",prop:"authName"}}),e._v(" "),r("el-table-column",{attrs:{label:"路径",prop:"path"}}),e._v(" "),r("el-table-column",{attrs:{label:"权限等级"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.level?r("el-tag",[e._v("一级")]):e._e(),e._v(" "),1==t.row.level?r("el-tag",{attrs:{type:"success"}},[e._v("二级")]):e._e(),e._v(" "),2==t.row.level?r("el-tag",{attrs:{type:"warning"}},[e._v("三级")]):e._e()]}}])})],1)],1)],1)},staticRenderFns:[]};var R=r("VU/8")(C,$,!1,function(e){r("/Ai2")},"data-v-1fa2083c",null).exports,F={data:function(){return{roleList:[],rightList:[],checkedKeys:[],addRoleForm:{roleName:"",roleDesc:""},addRoleFormRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"}]},editRoleForm:{},editRoleFormRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"}]},treeProps:{children:"children",label:"authName"},addDialogVisible:!1,editDialogVisible:!1,setDialogVisible:!1,currentRoleId:0}},created:function(){this.getRoleList()},methods:{getRoleList:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("roles");case 2:if(r=t.sent,console.log(r),200===r.data.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取角色失败"));case 6:e.$message.success("获取角色成功"),e.roleList=r.data.data;case 8:case"end":return t.stop()}},t,e)}))()},showAddRoleDialog:function(){this.addDialogVisible=!0},addRoleCloseDialog:function(){this.$refs.addRoleFormRef.resetFields()},setRightCloseDialog:function(){this.checkedKeys.splice(0,this.checkedKeys.length)},addRole:function(){var e,t=this;this.$refs.addRoleFormRef.validate((e=m()(c.a.mark(function e(r){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("roles",t.addRoleForm);case 4:if(a=e.sent,console.log(a),201===a.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("创建角色失败"));case 8:t.$message.success("创建角色成功"),t.addDialogVisible=!1,t.getRoleList();case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},showEditRoleDialog:function(e){var t=this;return m()(c.a.mark(function r(){var a;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.editDialogVisible=!0,r.next=3,t.$http.get("roles/"+e);case 3:if(a=r.sent,console.log(a),200===a.data.meta.status){r.next=7;break}return r.abrupt("return",t.$message.error("获取角色失败"));case 7:t.$message.success("获取角色成功"),t.editRoleForm=a.data.data;case 9:case"end":return r.stop()}},r,t)}))()},editRoleCloseDialog:function(){this.$refs.editRoleFormRef.resetFields()},editRole:function(){var e,t=this;this.$refs.editRoleFormRef.validate((e=m()(c.a.mark(function e(r){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.put("roles/"+t.editRoleForm.roleId,{roleName:t.editRoleForm.roleName,roleDesc:t.editRoleForm.roleDesc});case 4:if(a=e.sent,console.log(a),200===a.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("修改角色失败"));case 8:t.$message.success("修改角色成功"),t.editDialogVisible=!1,t.getRoleList();case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},deleteRole:function(e){var t=this;return m()(c.a.mark(function r(){return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("此操作将永久删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 2:if("confirm"===r.sent){r.next=5;break}return r.abrupt("return",t.$message.info("取消删除角色"));case 5:return r.next=7,t.$http.delete("roles/"+e);case 7:if(200===r.sent.data.meta.status){r.next=10;break}return r.abrupt("return",t.$message.error("删除角色失败"));case 10:t.$message.success("删除角色完毕"),t.getRoleList();case 12:case"end":return r.stop()}},r,t)}))()},deleteRight:function(e,t){var r=this;return m()(c.a.mark(function a(){var n;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.$confirm("此操作将永久删除该权限, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 2:if("confirm"===a.sent){a.next=5;break}return a.abrupt("return",r.$message.info("取消删除权限"));case 5:return a.next=7,r.$http.delete("roles/"+e.id+"/rights/"+t);case 7:if(n=a.sent,console.log(n),200===n.data.meta.status){a.next=11;break}return a.abrupt("return",r.$message.error("删除权限失败"));case 11:r.$message.success("删除权限成功"),e.children=n.data.data;case 13:case"end":return a.stop()}},a,r)}))()},showSetRightDialog:function(e){var t=this;return m()(c.a.mark(function r(){var a;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t.currentRoleId=e.id,t.getLeafKeys(e,t.checkedKeys),t.setDialogVisible=!0,r.next=5,t.$http.get("rights/tree");case 5:if(a=r.sent,console.log(a),200===a.data.meta.status){r.next=9;break}return r.abrupt("return",t.$message.error("获取权限失败"));case 9:t.$message.success("获取权限成功"),t.rightList=a.data.data;case 11:case"end":return r.stop()}},r,t)}))()},setRight:function(){var e=this;return m()(c.a.mark(function t(){var r,a,n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=[e.$refs.treeRef.getCheckedKeys(),e.$refs.treeRef.getHalfCheckedKeys()],a=r.join(","),t.next=4,e.$http.post("roles/"+e.currentRoleId+"/rights",{rids:a});case 4:if(n=t.sent,console.log(n),200===n.data.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error("修改权限失败"));case 8:e.$message.success("修改权限成功"),e.setDialogVisible=!1,e.getRoleList();case 11:case"end":return t.stop()}},t,e)}))()},getLeafKeys:function(e,t){var r=this;if(!e.children)return t.push(e.id);e.children.forEach(function(e){return r.getLeafKeys(e,t)})}}},D={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/welcome"}}},[e._v("首页")]),e._v(" "),r("el-breadcrumb-item",[e._v("权限管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("角色列表")])],1),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.showAddRoleDialog}},[e._v("添加角色")]),e._v(" "),r("el-table",{attrs:{data:e.roleList,stripe:""}},[r("el-table-column",{attrs:{label:" ",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.children,function(a,n){return r("el-row",{key:a.id,class:["borderBottom",0===n?"borderTop":"","vcenter"]},[r("el-col",{attrs:{span:5}},[r("el-tag",{attrs:{closable:""},on:{close:function(r){return e.deleteRight(t.row,a.id)}}},[e._v(e._s(a.authName))]),e._v(" "),r("i",{staticClass:"el-icon-caret-right"})],1),e._v(" "),r("el-col",{attrs:{span:19}},e._l(a.children,function(a,n){return r("el-row",{key:a.id,class:[0===n?"":"borderTop","vcenter"]},[r("el-col",{attrs:{span:6}},[r("el-tag",{attrs:{type:"success",closable:""},on:{close:function(r){return e.deleteRight(t.row,a.id)}}},[e._v(e._s(a.authName))]),e._v(" "),r("i",{staticClass:"el-icon-caret-right"})],1),e._v(" "),r("el-col",{attrs:{span:18}},e._l(a.children,function(a){return r("el-tag",{key:a.id,attrs:{type:"warning",closable:""},on:{close:function(r){return e.deleteRight(t.row,a.id)}}},[e._v("\n                                    "+e._s(a.authName)+"\n                                ")])}),1)],1)}),1)],1)})}}])}),e._v(" "),r("el-table-column",{attrs:{label:"#",type:"index"}}),e._v(" "),r("el-table-column",{attrs:{label:"角色名称",prop:"roleName"}}),e._v(" "),r("el-table-column",{attrs:{label:"角色描述",prop:"roleDesc"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showEditRoleDialog(t.row.id)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteRole(t.row.id)}}},[e._v("删除")]),e._v(" "),r("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(r){return e.showSetRightDialog(t.row)}}},[e._v("分配权限")])]}}])})],1),e._v(" "),r("el-dialog",{attrs:{title:"添加角色",visible:e.addDialogVisible,width:"40%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addRoleCloseDialog}},[r("el-form",{ref:"addRoleFormRef",attrs:{model:e.addRoleForm,rules:e.addRoleFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addRole(t)}},model:{value:e.addRoleForm.roleName,callback:function(t){e.$set(e.addRoleForm,"roleName",t)},expression:"addRoleForm.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addRole(t)}},model:{value:e.addRoleForm.roleDesc,callback:function(t){e.$set(e.addRoleForm,"roleDesc",t)},expression:"addRoleForm.roleDesc"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addRole}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"修改角色",visible:e.editDialogVisible,width:"40%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editRoleCloseDialog}},[r("el-form",{ref:"editRoleFormRef",attrs:{model:e.editRoleForm,rules:e.editRoleFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editRole(t)}},model:{value:e.editRoleForm.roleName,callback:function(t){e.$set(e.editRoleForm,"roleName",t)},expression:"editRoleForm.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editRole(t)}},model:{value:e.editRoleForm.roleDesc,callback:function(t){e.$set(e.editRoleForm,"roleDesc",t)},expression:"editRoleForm.roleDesc"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.editRole}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"分配权限",visible:e.setDialogVisible,width:"40%"},on:{"update:visible":function(t){e.setDialogVisible=t},close:e.setRightCloseDialog}},[r("el-tree",{ref:"treeRef",attrs:{data:e.rightList,props:e.treeProps,"node-key":"id","default-checked-keys":e.checkedKeys,"show-checkbox":"","default-expand-all":""}}),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.setDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.setRight}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var O=r("VU/8")(F,D,!1,function(e){r("6ZWM")},"data-v-1202b096",null).exports,L=r("ugRU"),V={data:function(){return{categoryList:[],attributeList:[],paramList:[],cascaderProps:{expandTrigger:"hover",value:"cat_id",label:"cat_name",children:"children"},selectedCategoryId:[],activeName:"many",addAttributeOrParamDialogVisible:!1,editAttributeOrParamDialogVisible:!1,addAttributeOrParamForm:{attr_name:"",attr_sel:"",attr_vals:""},editAttributeOrParamForm:{attr_name:"",attr_sel:"",attr_vals:""},addAttributeOrParamFormRules:{attr_name:[{required:!0,message:"请输入参数",trigger:"blur"}]},editAttributeOrParamFormRules:{attr_name:[{required:!0,message:"请输入参数",trigger:"blur"}]},editAttributeOrParamId:0}},created:function(){this.getCategoryList()},methods:{handleChange:function(){if(3!==this.selectedCategoryId.length)return this.selectedCategoryId.splice(0,this.selectedCategoryId.length),this.paramList.splice(0,this.paramList.length),void this.attributeList.splice(0,this.attributeList.length);this.getAttributeListOrParamList()},handleTabClick:function(){this.getAttributeListOrParamList()},handleInputConfirm:function(e){var t=this;return m()(c.a.mark(function r(){var a;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(0!==e.inputValue.trim().length){r.next=4;break}return e.inputVisible=!1,e.inputValue="",r.abrupt("return");case 4:return e.attr_vals.push(e.inputValue.trim()),e.inputVisible=!1,e.inputValue="",r.next=9,t.$http.put("categories/"+t.selectedCategoryId[t.selectedCategoryId.length-1]+"/attributes/"+e.attr_id,{attr_name:e.attr_name,attr_sel:e.attr_sel,attr_vals:e.attr_vals.join(" ")});case 9:if(a=r.sent,console.log(a),200===a.data.meta.status){r.next=13;break}return r.abrupt("return",t.$message.error("新增标签失败"));case 13:t.$message.success("新增标签成功");case 14:case"end":return r.stop()}},r,t)}))()},getCategoryList:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("categories");case 2:if(r=t.sent,console.log(r),200===r.data.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取分类失败"));case 6:e.$message.success("获取分类成功"),e.categoryList=r.data.data;case 8:case"end":return t.stop()}},t,e)}))()},getAttributeListOrParamList:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.selectedCategoryId.length){t.next=2;break}return t.abrupt("return",e.$message.error("请先选择分类"));case 2:return t.next=4,e.$http.get("categories/"+e.selectedCategoryId[e.selectedCategoryId.length-1]+"/attributes",{params:{sel:e.activeName}});case 4:if(r=t.sent,console.log(r),200===r.data.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error("获取数据失败"));case 8:e.$message.success("获取数据成功"),r.data.data.forEach(function(e){e.attr_vals=e.attr_vals?e.attr_vals.split(" "):[],e.inputVisible=!1,e.inputValue=""}),"many"===e.activeName&&(e.paramList=r.data.data),"only"===e.activeName&&(e.attributeList=r.data.data);case 12:case"end":return t.stop()}},t,e)}))()},deleteAttributeOrParam:function(e){var t=this;return m()(c.a.mark(function r(){var a,n;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a="","many"===t.activeName&&(a="参数"),"only"===t.activeName&&(a="属性"),r.next=5,t.$confirm("此操作将永久删除该"+a+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 5:if("confirm"===r.sent){r.next=8;break}return r.abrupt("return",t.$message.info("取消删除"+a));case 8:return r.next=10,t.$http.delete("categories/"+t.selectedCategoryId[t.selectedCategoryId.length-1]+"/attributes/"+e);case 10:if(n=r.sent,console.log(n),200===n.data.meta.status){r.next=14;break}return r.abrupt("return",t.$message.error("删除"+a+"失败"));case 14:t.$message.success("删除"+a+"成功"),t.getAttributeListOrParamList();case 16:case"end":return r.stop()}},r,t)}))()},addAttributeOrParam:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r="","many"===e.activeName&&(r="参数"),"only"===e.activeName&&(r="属性"),e.$refs.addAttributeOrParamFormRef.validate(function(){var t=m()(c.a.mark(function t(a){var n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$http.post("categories/"+e.selectedCategoryId[e.selectedCategoryId.length-1]+"/attributes",{attr_name:e.addAttributeOrParamForm.attr_name,attr_sel:e.activeName});case 4:if(n=t.sent,console.log(n),201===n.data.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error("添加"+r+"失败"));case 8:e.$message.success("添加"+r+"成功"),e.addAttributeOrParamDialogVisible=!1,e.getAttributeListOrParamList();case 11:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}},t,e)}))()},showAddAttributeOrParamDialog:function(){this.addAttributeOrParamDialogVisible=!0},addAttributeOrParamCloseDialog:function(){this.$refs.addAttributeOrParamFormRef.resetFields()},editAttributeOrParamCloseDialog:function(){this.$refs.editAttributeOrParamFormRef.resetFields()},showEditAttributeOrParamDialog:function(e){this.editAttributeOrParamDialogVisible=!0,this.editAttributeOrParamId=e,console.log(this.editAttributeOrParamId)},editAttributeOrParam:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r="","many"===e.activeName&&(r="参数"),"only"===e.activeName&&(r="属性"),e.$refs.editAttributeOrParamFormRef.validate(function(){var t=m()(c.a.mark(function t(a){var n;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$http.put("categories/"+e.selectedCategoryId[e.selectedCategoryId.length-1]+"/attributes/"+e.editAttributeOrParamId,{attr_name:e.editAttributeOrParamForm.attr_name,attr_sel:e.activeName});case 4:if(n=t.sent,console.log(n),200===n.data.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error("修改"+r+"失败"));case 8:e.$message.success("修改"+r+"成功"),e.editAttributeOrParamDialogVisible=!1,e.getAttributeListOrParamList();case 11:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}());case 4:case"end":return t.stop()}},t,e)}))()},showInput:function(e){var t=this;e.inputVisible=!0,this.$nextTick(function(e){t.$refs.inputRef.$refs.input.focus()})},deleteTag:function(e,t){var r=this;return m()(c.a.mark(function a(){var n;return c.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e.attr_vals.splice(t,1),a.next=3,r.$http.put("categories/"+r.selectedCategoryId[r.selectedCategoryId.length-1]+"/attributes/"+e.attr_id,{attr_name:e.attr_name,attr_sel:e.attr_sel,attr_vals:e.attr_vals.join(" ")});case 3:if(n=a.sent,console.log(n),200===n.data.meta.status){a.next=7;break}return a.abrupt("return",r.$message.error("删除标签失败"));case 7:r.$message.success("删除标签成功");case 8:case"end":return a.stop()}},a,r)}))()}},computed:{isButtonDisable:function(){return 3!==this.selectedCategoryId.length},getActiveName:function(){return"many"===this.activeName?"动态参数":"only"===this.activeName?"静态属性":void 0}}},U={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/welcome"}}},[e._v("首页")]),e._v(" "),r("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("分类参数")])],1),e._v(" "),r("el-card",[r("el-alert",{attrs:{type:"warning",title:"注意：只允许为第三级分类设置相关参数",closable:!1,"show-icon":""}}),e._v(" "),r("el-row",[r("el-col",[r("span",[e._v("选择商品分类")]),e._v(" "),r("el-cascader",{attrs:{options:e.categoryList,props:e.cascaderProps,clearable:""},on:{change:e.handleChange},model:{value:e.selectedCategoryId,callback:function(t){e.selectedCategoryId=t},expression:"selectedCategoryId"}})],1)],1),e._v(" "),r("el-tabs",{on:{"tab-click":e.handleTabClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"动态参数",name:"many"}},[r("el-button",{attrs:{type:"primary",size:"mini",disabled:e.isButtonDisable},on:{click:e.showAddAttributeOrParamDialog}},[e._v("添加参数")]),e._v(" "),r("el-table",{attrs:{data:e.paramList,stripe:""}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.attr_vals,function(a,n){return r("el-tag",{key:n,attrs:{closable:""},on:{close:function(r){return e.deleteTag(t.row,n)}}},[e._v(" "+e._s(a))])}),e._v(" "),t.row.inputVisible?r("el-input",{ref:"inputRef",staticClass:"input-tag",attrs:{size:"small"},on:{blur:function(r){return e.handleInputConfirm(t.row)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:t.row.inputValue,callback:function(r){e.$set(t.row,"inputValue",r)},expression:"scope.row.inputValue"}}):r("el-button",{staticClass:"button-tag",attrs:{size:"small"},on:{click:function(r){return e.showInput(t.row)}}},[e._v("+ New Tag")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"#",type:"index"}}),e._v(" "),r("el-table-column",{attrs:{label:"参数名称",prop:"attr_name"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(r){return e.showEditAttributeOrParamDialog(t.row.attr_id)}}},[e._v("修改")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(r){return e.deleteAttributeOrParam(t.row.attr_id)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),r("el-tab-pane",{attrs:{label:"静态属性",name:"only"}},[r("el-button",{attrs:{type:"primary",size:"mini",disabled:e.isButtonDisable},on:{click:e.showAddAttributeOrParamDialog}},[e._v("添加属性")]),e._v(" "),r("el-table",{attrs:{data:e.attributeList,stripe:""}},[r("el-table-column",{attrs:{label:"",type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._l(t.row.attr_vals,function(a,n){return r("el-tag",{key:n,attrs:{closable:""},on:{close:function(r){return e.deleteTag(t.row,n)}}},[e._v(" "+e._s(a))])}),e._v(" "),t.row.inputVisible?r("el-input",{ref:"inputRef",staticClass:"input-tag",attrs:{size:"small"},on:{blur:function(r){return e.handleInputConfirm(t.row)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm(t)}},model:{value:t.row.inputValue,callback:function(r){e.$set(t.row,"inputValue",r)},expression:"scope.row.inputValue"}}):r("el-button",{staticClass:"button-tag",attrs:{size:"small"},on:{click:function(r){return e.showInput(t.row)}}},[e._v("+ New Tag")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"#",type:"index"}}),e._v(" "),r("el-table-column",{attrs:{label:"属性名称",prop:"attr_name"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(r){return e.showEditAttributeOrParamDialog(t.row.attr_id)}}},[e._v("修改")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(r){return e.deleteAttributeOrParam(t.row.attr_id)}}},[e._v("删除")])]}}])})],1)],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"添加"+e.getActiveName,visible:e.addAttributeOrParamDialogVisible,width:"40%"},on:{"update:visible":function(t){e.addAttributeOrParamDialogVisible=t},close:e.addAttributeOrParamCloseDialog}},[r("el-form",{ref:"addAttributeOrParamFormRef",attrs:{model:e.addAttributeOrParamForm,rules:e.addAttributeOrParamFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:e.getActiveName,prop:"attr_name"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addAttributeOrParam(t)}},model:{value:e.addAttributeOrParamForm.attr_name,callback:function(t){e.$set(e.addAttributeOrParamForm,"attr_name",t)},expression:"addAttributeOrParamForm.attr_name"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addAttributeOrParamDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addAttributeOrParam}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"修改"+e.getActiveName,visible:e.editAttributeOrParamDialogVisible,width:"40%"},on:{"update:visible":function(t){e.editAttributeOrParamDialogVisible=t},close:e.editAttributeOrParamCloseDialog}},[r("el-form",{ref:"editAttributeOrParamFormRef",attrs:{model:e.editAttributeOrParamForm,rules:e.editAttributeOrParamFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:e.getActiveName,prop:"attr_name"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editAttributeOrParam(t)}},model:{value:e.editAttributeOrParamForm.attr_name,callback:function(t){e.$set(e.editAttributeOrParamForm,"attr_name",t)},expression:"editAttributeOrParamForm.attr_name"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editAttributeOrParamDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.editAttributeOrParam}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var A=r("VU/8")(V,U,!1,function(e){r("qKKd")},"data-v-acc96ab4",null).exports,I={data:function(){return{queryInfo:{type:3,pagenum:1,pagesize:10},columns:[{label:"分类名称",prop:"cat_name"},{label:"是否有效",prop:"cat_deleted",type:"template",template:"isOK"},{label:"排序",prop:"cat_level",type:"template",template:"sort"},{label:"操作",type:"template",template:"operate"}],addCategoryRules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},editCategoryRules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},categoryList:[],categoryListSize:0,addCategoryForm:{cat_name:"",cat_pid:0,cat_level:0},addCategoryDialogVisible:!1,editCategoryDialogVisible:!1,parentCategoryList:[],selectedCategoryId:[],cascaderProps:{value:"cat_id",label:"cat_name",children:"children",expandTrigger:"hover"},editCategoryForm:{cat_name:"",cat_id:0}}},created:function(){this.getCategoryList()},methods:{handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getCategoryList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getCategoryList()},handleChange:function(){if(this.selectedCategoryId.length>0)return this.addCategoryForm.cat_pid=this.selectedCategoryId[this.selectedCategoryId.length-1],this.addCategoryForm.cat_level=this.selectedCategoryId.length,void console.log(this.addCategoryForm);this.addCategoryForm.cat_level=0,console.log(this.addCategoryForm)},getCategoryList:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("categories",{params:e.queryInfo});case 2:if(r=t.sent,console.log(r),200===r.data.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取分类失败"));case 6:e.$message.success("获取分类成功"),e.categoryList=r.data.data.result,e.categoryListSize=r.data.data.total;case 9:case"end":return t.stop()}},t,e)}))()},showAddCategoryDialog:function(){var e=this;return m()(c.a.mark(function t(){var r;return c.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.addCategoryDialogVisible=!0,t.next=3,e.$http.get("categories",{params:{type:2}});case 3:if(r=t.sent,console.log(r),200===r.data.meta.status){t.next=7;break}return t.abrupt("return",e.$message.error("获取父级分类失败"));case 7:e.$message.success("获取父级分类成功"),e.parentCategoryList=r.data.data;case 9:case"end":return t.stop()}},t,e)}))()},addCategoryCloseDialog:function(){this.$refs.addCategoryFormRef.resetFields(),this.selectedCategoryId=[],this.addCategoryForm.cat_pid=0,this.addCategoryForm.cat_level=0},addCategory:function(){var e,t=this;this.$refs.addCategoryFormRef.validate((e=m()(c.a.mark(function e(r){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$http.post("categories",t.addCategoryForm);case 4:if(a=e.sent,console.log(a),201===a.data.meta.status){e.next=8;break}return e.abrupt("return",t.$message.error("添加分类失败"));case 8:t.$message.success("添加分类成功"),t.addCategoryDialogVisible=!1,t.getCategoryList();case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))},deleteCategory:function(e){var t=this;return m()(c.a.mark(function r(){var a;return c.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.$confirm("此操作将永久删除该分类, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(function(e){return e});case 2:if("confirm"===r.sent){r.next=5;break}return r.abrupt("return",t.$message.info("取消删除分类"));case 5:return r.next=7,t.$http.delete("categories/"+e);case 7:if(a=r.sent,console.log(a),200===a.data.meta.status){r.next=11;break}return r.abrupt("return",t.$message.error("删除分类失败"));case 11:t.$message.success("删除分类完毕"),t.getCategoryList();case 13:case"end":return r.stop()}},r,t)}))()},showEditCategoryDialog:function(e){this.editCategoryForm.cat_id=e.cat_id,this.editCategoryDialogVisible=!0},editCategoryCloseDialog:function(){this.$refs.editCategoryFormRef.resetFields()},editCategory:function(){var e,t=this;this.$refs.editCategoryFormRef.validate((e=m()(c.a.mark(function e(r){var a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return t.editCategoryDialogVisible=!1,e.next=5,t.$http.put("categories/"+t.editCategoryForm.cat_id,{cat_name:t.editCategoryForm.cat_name});case 5:if(a=e.sent,console.log(a),200===a.data.meta.status){e.next=9;break}return e.abrupt("return",t.$message.error("修改分类失败"));case 9:t.$message.success("修改分类完毕"),t.getCategoryList();case 11:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))}}},P={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/welcome"}}},[e._v("首页")]),e._v(" "),r("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("商品分类")])],1),e._v(" "),r("el-card",[r("el-button",{attrs:{type:"primary"},on:{click:e.showAddCategoryDialog}},[e._v("添加分类")]),e._v(" "),r("tree-table",{attrs:{data:e.categoryList,columns:e.columns,"selection-type":!1,"expand-type":!1,"show-index":""},scopedSlots:e._u([{key:"isOK",fn:function(e){return[!1===e.row.cat_deleted?r("i",{staticClass:"el-icon-success",staticStyle:{color:"lightgreen"}}):r("i",{staticClass:"el-icon-error",staticStyle:{color:"red"}})]}},{key:"sort",fn:function(t){return[0==t.row.cat_level?r("el-tag",[e._v("一级")]):e._e(),e._v(" "),1==t.row.cat_level?r("el-tag",{attrs:{type:"success"}},[e._v("二级")]):e._e(),e._v(" "),2==t.row.cat_level?r("el-tag",{attrs:{type:"warning"}},[e._v("三级")]):e._e()]}},{key:"operate",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.showEditCategoryDialog(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.deleteCategory(t.row.cat_id)}}},[e._v("删除")])]}}])}),e._v(" "),r("el-dialog",{attrs:{title:"添加分类",visible:e.addCategoryDialogVisible,width:"40%"},on:{"update:visible":function(t){e.addCategoryDialogVisible=t},close:e.addCategoryCloseDialog}},[r("el-form",{ref:"addCategoryFormRef",attrs:{model:e.addCategoryForm,rules:e.addCategoryRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"分类名称",prop:"cat_name"}},[r("el-input",{model:{value:e.addCategoryForm.cat_name,callback:function(t){e.$set(e.addCategoryForm,"cat_name",t)},expression:"addCategoryForm.cat_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"父级分类"}},[r("el-cascader",{attrs:{options:e.parentCategoryList,props:e.cascaderProps,clearable:""},on:{change:e.handleChange},model:{value:e.selectedCategoryId,callback:function(t){e.selectedCategoryId=t},expression:"selectedCategoryId"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addCategoryDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addCategory}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"修改分类",visible:e.editCategoryDialogVisible,width:"40%"},on:{"update:visible":function(t){e.editCategoryDialogVisible=t},close:e.editCategoryCloseDialog}},[r("el-form",{ref:"editCategoryFormRef",attrs:{model:e.editCategoryForm,rules:e.editCategoryRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"分类名称",prop:"cat_name"}},[r("el-input",{model:{value:e.editCategoryForm.cat_name,callback:function(t){e.$set(e.editCategoryForm,"cat_name",t)},expression:"editCategoryForm.cat_name"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editCategoryDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.editCategory}},[e._v("确 定")])],1)],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[10,25,50],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.categoryListSize},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var z=r("VU/8")(I,P,!1,function(e){r("sUHt")},"data-v-5b71e8bf",null).exports,E=r("GlBT"),N=r("zVpJ");a.default.use(l.a);var q=new l.a({routes:[{path:"/",redirect:"/login"},{path:"/login",component:g},{path:"/home",component:h,redirect:"/welcome",children:[{path:"/welcome",component:y},{path:"/users",component:x},{path:"/rights",component:R},{path:"/roles",component:O},{path:"/goods",component:L.default},{path:"/params",component:A},{path:"/categories",component:z},{path:"/orders",component:E.default},{path:"/reports",component:N.default}]}]});q.beforeEach(function(e,t,r){return"/login"===e.path?r():window.sessionStorage.getItem("token")?void r():r("/login")});var S=q,T=(r("J373"),r("mtWM")),B=r.n(T),K=r("j/gt"),j=r.n(K);B.a.defaults.baseURL="https://www.liulongbin.top:8888/api/private/v1/",B.a.interceptors.request.use(function(e){return e.headers.Authorization=window.sessionStorage.getItem("token"),e}),a.default.prototype.$http=B.a,a.default.config.productionTip=!1,a.default.use(o.a),a.default.component("tree-table",j.a),new a.default({el:"#app",router:S,components:{App:s},template:"<App/>"})},OVeQ:function(e,t,r){"use strict";var a={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h3",[this._v("角色")])])}]};t.a=a},Ouqj:function(e,t,r){"use strict";var a={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h3",[this._v("角色")])])}]};t.a=a},Ykfr:function(e,t){},bT1s:function(e,t,r){"use strict";var a={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("h3",[this._v("商品")])])}]};t.a=a},m2qn:function(e,t){},qKKd:function(e,t){},qkMw:function(e,t){},sUHt:function(e,t){},tBG6:function(e,t){},tvR6:function(e,t){},ugRU:function(e,t,r){"use strict";var a=r("DaeS"),n=r.n(a),s=r("bT1s");var i=function(e){r("m2qn")},o=r("VU/8")(n.a,s.a,!1,i,"data-v-3a65f0fc",null);t.default=o.exports},wJg8:function(e,t){},zVpJ:function(e,t,r){"use strict";var a=r("Cm+n"),n=r.n(a),s=r("Ouqj");var i=function(e){r("1nDT")},o=r("VU/8")(n.a,s.a,!1,i,"data-v-69764433",null);t.default=o.exports}},["NHnr"]);
//# sourceMappingURL=app.0576140344c470151adb.js.map